# Word Search Captcha!
A word search puzzle captcha created for the Kitboga Code Jam 2025.

This captcha requires solving one or more word search puzzles that take on the appearance of traditional text-based captchas. Each puzzle is procedurally generated by implementing the word search construction algorithm outlined in this [paper](https://ijses.com/wp-content/uploads/2022/01/68-IJSES-V6N1.pdf).

## Creating a Word Search
Creating a word search at *minimum* requires an array of strings. This will create a square grid whose size is the length of the longest word. All words will be placed upon generating the puzzle. 

```javascript
let wordSearch = new WordSearch({
  words: ["purple", "pig", "blue", "baboon"]
})
```
Alternatively, defining `numberOfWords` will randomly select and place only the specified number of words. In this way, generating multiple puzzles from a single WordSearch object becomes possible with a sufficiently long words array.

```javascript
let wordSearch = new WordSearch({
  words: ["purple", "pig", "colorful", "comrade", "blue", "baboon"],
  numberOfWords: 3,
  rows: 6
})
```

By default, words placed in a generated word search will not be reused in successive generation attempts. This behavior can be enabled using the `recycleWords` property.

The size of the grid can be controlled by specifying `rows` and/or `columns`. Only including one dimension will create a square grid of that size. Words too large to fit will be filtered out. In the second example above, the words *colorful* and *comrade* would be removed.

Directions words can be placed in is configurable through the `directions` property. The default directions are: down, down-right, right, and up-right. These default directions can be changed via the `DIRECTIONS` static variable. 

Finally, all grid spaces not belonging to a placed word are filled with random letters by default. These spaces can be left empty for debugging purposes by changing the `fillEmpty` property.

## Generating a Word Search 
Word searches are generated by calling the generate method of the WordSearch object. 

This can throw an error in a couple ways: having an insufficient number of words and failing to find a valid placement of words. The first issue occurs when there are no unused words remaining or the number of unused words is less than the desired `numberOfWords` to place. Second, there is no guarantee in finding a valid placement of words. This could be the result of trying to place too many words for a given puzzle size or the words' letters being incompatible and unable to overlap.

The generate method will make a fixed number of attempts to select and place words,  configurable via the `GENERATION_ATTEMPTS` static variable. Each valid word placement found is scored according to how many words are aligned. More alignment results in a lower score. The highest scoring placement of words is then used as the resulting word search. This should ideally reduce the probability of generating a puzzle where the majority of words lie in the same direction.

## Captcha Features
This captcha can require solving more than one word search in succession, each with its own parameters and difficulty. 

Enabling failing will generate a new word search after making a specified number of incorrect word selections. Additionally, a refresh button allows the generation of a new puzzle at any time.

If the generate method throws an error, the current WordSearch object is substituted with one of the same size and number of placed words. But, by using a large words array and enabling `recycleWords`, it should better handle generating multiple puzzles. 

Toggling noise images and a displacement filter can give the appearance of a traditional captcha and make letters harder to read. The strength of the displacement effect is configurable by adjusting displacement scale.

Selecting letters draws a stroke on canvas elements underneath. The radius of this stroke as well as the font size of the letters are proportional to the side length of a single square grid cell. When experimenting with different fonts, it may be necessary to adjust `LETTER_SCALE` and `STROKE_SCALE` to ensure strokes fully envelope letters.

Depending on the relative aspect ratios of the game container and the puzzle dimensions, the puzzle will expand to fill its container with letter-box or pillar-box styling.

### Thank you to Kitboga and team for hosting this event!

## Credits
The following was used or referenced in the creation of this repository.

[numberstowords](https://github.com/rajch/numberstowords) by rajch and licensed  [MIT](https://github.com/rajch/numberstowords/blob/master/LICENSE)

[WoSeCon](https://github.com/lmous/WoSeCon) by Lefteris Moussiades and licensed [MIT](https://github.com/lmous/WoSeCon/blob/main/LICENSE)

[A Word Search Puzzle Construction Algorithm](https://ijses.com/wp-content/uploads/2022/01/68-IJSES-V6N1.pdf) by Lefteris Moussiades